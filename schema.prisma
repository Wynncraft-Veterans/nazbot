datasource db {
  provider = "sqlite"
  url      = "file:dev.db"
}

generator db {
  provider             = "prisma-client-py"
  interface            = "asyncio"
  recursive_type_depth = 5
}

model Person {
  id               String             @id @default(cuid())
  name             String?
  MinecraftAccount MinecraftAccount[]
  DiscordAccount   DiscordAccount[]
}

model MinecraftAccount {
  id       String  @id @default(cuid())
  person   Person? @relation(fields: [personId], references: [id])
  personId String?
  uuid     String
  guild    String?
  lastOnline DateTime?
}

model DiscordAccount {
  id       String  @id @default(cuid())
  person   Person? @relation(fields: [personId], references: [id])
  personId String?
  discUUID String  @unique
  Shout    Shout[]
  Score    Score[]
}

model WeeklyEvent {
  id    String  @id @default(cuid())
  title String?
  week  Int     @unique
  Score Score[]
}

model Score {
  id               String         @id @default(cuid())
  event            WeeklyEvent    @relation(fields: [weeklyEventId], references: [id])
  discordAccount   DiscordAccount @relation(fields: [discordAccountId], references: [id])
  score            Int
  weeklyEventId    String
  discordAccountId String

  @@unique([weeklyEventId, discordAccountId])
}

model DeadGuildAlert {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
}

model GuildCapacityAlert {
  id        String   @id @default(cuid())
  createdAt DateTime @default(now())
}

model Shout {
  id               String         @id @default(cuid())
  person           DiscordAccount @relation(fields: [discordAccountId], references: [id])
  createdAt        DateTime       @default(now())
  discordAccountId String
}
